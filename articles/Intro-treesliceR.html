<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to treesliceR • treesliceR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to treesliceR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">treesliceR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Intro-treesliceR.html">Introduction to treesliceR</a></li>
    <li><a class="dropdown-item" href="../articles/Passeriformes-distribution.html">Passerines Distribution</a></li>
    <li><a class="dropdown-item" href="../articles/Passeriformes-diversification.html">Passerines Diversification</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AraujoMat/treesliceR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to treesliceR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AraujoMat/treesliceR/blob/master/vignettes/Intro-treesliceR.Rmd" class="external-link"><code>vignettes/Intro-treesliceR.Rmd</code></a></small>
      <div class="d-none name"><code>Intro-treesliceR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="prelude">Prelude<a class="anchor" aria-label="anchor" href="#prelude"></a>
</h2>
<p><code>treesliceR</code> is an R package that offers versatile tools
for subsetting and slicing phylogenetic trees at various depths and
orientations. Sliced and pruned phylogenies generated with
<code>treesliceR</code> are readily available for downstream analysis,
facilitating the evaluation of phylogenetic patterns such as alpha and
beta phylogenetic metrics. With <code>treesliceR</code>, phylogenies can
be sliced in different temporal orientations, either “rootwardly” or
“tipwardly”, and internally using diverse temporal criteria such as
million od years, accumulated phylogenetic diversity, or quantiles of
tip ages distribution.</p>
<p>Moreover, <code>treesliceR</code> contains functions for assessing
the rates of accumulation of phylogenetic information (e.g., “α” and “β”
diversities) over time. For a comprehensive introduction to calculating
these metrics, refer to <a href="https://araujomat.github.io/treesliceR/articles/Passeriformes-diversification.html">this
vignette</a>. All analysis are designed to be flexible, reliable, and
efficient, with computationally time-demanding functions optimized for
parallel computation. Additionally, our package includes plotting
functions that enable the production of ready-to-use figures.</p>
<p>To demonstrate the basic usage of <code>treesliceR</code>, we will
provide examples illustrating how to subset and slice phylogenies in
different ways. To begin, it is necessary to load the <code>ape</code>
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading it</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span></code></pre></div>
<p>Now, we’ll need to load (and install if necessary) the
<code>treesliceR</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading it</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AraujoMat/treesliceR" class="external-link">treesliceR</a></span><span class="op">)</span></span></code></pre></div>
<p>To showcase the flexibility of <code>treesliceR</code>, we will
provide a demonstration on how to subset and slice a phylogenetic tree
for passarine species (308 species) included in the package (obtained
from <a href="https://doi.org/10.1038/nature11631" class="external-link">Jetz et
al. (2012)</a>). The <code>pass_tree</code> object comprises a
multiphylo object containing 100 passerine trees. For simplicity, we
will focus on a single tree. To load this dataset, we use the following
code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">pass_trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pruning-function">1. Pruning function<a class="anchor" aria-label="anchor" href="#pruning-function"></a>
</h2>
<p><code>treesliceR</code> encompasses functions for pruning a
phylogenetic tree based on a specific absolute tree depth or by
establishing a quantile value devied from the age distribution of the
last splitting events for the tips of a given phylogenetic tree. In both
procedures (absolute age or quantile), all tips with the age of the last
splitting event <strong>after</strong> or <strong>before</strong> the
value specified in the time argument will be pruned or retained in the
phylogeny (depending on the <code>method</code> argument). In the next
examples, we will illustrate how to prune the phylogenetic tree using an
absolute depth (in this case, in million of years) or a scalar
indicating a quantile drawn from the tip-species age distribution.</p>
<div class="section level3">
<h3 id="pruning-using-absolute-depth">1.1. Pruning using absolute depth<a class="anchor" aria-label="anchor" href="#pruning-using-absolute-depth"></a>
</h3>
<p>First, let’s prune the phylogeny to retain only species with
splitting events older than 10 and 30 millions years:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span>, qtl <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># keep species older than 10my</span></span>
<span><span class="va">tree_pruned30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, qtl <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># keep species older than 30my</span></span></code></pre></div>
<p>Lets check the format of those phylogenetic trees:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"All species"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned10</span>, main <span class="op">=</span> <span class="st">"Species older than 10my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned30</span>, main <span class="op">=</span> <span class="st">"Species older than 30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We can see that only tip-species with the last splitting events older
than 10 and 30 million years were retained in the trees. It is important
to note that the original branch lengths remain unchanged. From left to
right, we have the original phylogeny, the phylogeny containing only
species with the last splitting event older than 10 million years, and
finally, the phylogeny with species where the last branching event is
older than 30 million years (only three species in our example).</p>
<p>Conversely, the inverse procedure can also be done, allowing us to
keep only the species with the last branching event younger than the
<code>time</code> argument by setting the <code>method</code> argument
as 2. Therefore:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned10_inverse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span>, qtl <span class="op">=</span> <span class="cn">F</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># keep species younger than 10my</span></span>
<span><span class="va">tree_pruned30_inverse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, qtl <span class="op">=</span> <span class="cn">F</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># keep species younger than 30my</span></span>
<span></span>
<span><span class="co"># plotting phylogenies</span></span>
<span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"All species"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned10_inverse</span>, main <span class="op">=</span> <span class="st">"Species younger than 10my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned30_inverse</span>, main <span class="op">=</span> <span class="st">"Species younger than 30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="pruning-using-depth-quantiles">1.2. Pruning using depth quantiles<a class="anchor" aria-label="anchor" href="#pruning-using-depth-quantiles"></a>
</h3>
<p>The same procedure can be applied by setting the <code>time</code>
argument as a scalar indicating the quantile of the distribution of
tip-species ages, given by the time of the last branching event. For
instance, to retain only species with age values younger (lower) than
the ages of 25th quantile of the age distribution of all species, we can
do the following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned25q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fl">0.25</span>, qtl <span class="op">=</span> <span class="cn">T</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned25q</span>, main <span class="op">=</span> <span class="st">"Species with ages younger than 25th quantile"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Note that if we aim to retain species with ages younger than the 25th
quantile, the <code>method</code> argument must be set as 2, as
illustrated in the above example. The default value is 1, signifying the
removal of tips with ages younger than the threshold specified in the
<code>time</code> argument.</p>
</div>
</div>
<div class="section level2">
<h2 id="slicing-functions">2. Slicing functions<a class="anchor" aria-label="anchor" href="#slicing-functions"></a>
</h2>
<p>The second family of functions present within <code>treesliceR</code>
enables the slicing of phylogeny in vairous ways. In this section, we
will show the flexibility of <code>treesliceR</code> in performing tree
slicing and visualizing the output of these functions.</p>
<div class="section level3">
<h3 id="slicing-from-the-tips-to-the-root">2.1. Slicing from the tips to the root<a class="anchor" aria-label="anchor" href="#slicing-from-the-tips-to-the-root"></a>
</h3>
<p>The first option to slice phylogenies is by squeezing its branch
lengths from the tips to the root using the function
<code><a href="../reference/squeeze_tips.html">squeeze_tips()</a></code>. Squeezing, in this context, refers to
collapsing branch lengths based on a given threshold (tree depth, in
this case, in million years). This function requires providing a
phylogenetic tree and a numeric value indicating the depth at which the
branches will be compressed. For instance, let’s squeeze the passerine
phylogeny at three different ages (10, 30 and 50 million years):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_squeeze10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize the phylogeny before and after the squeezing process
to check out the differences:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze10</span>, main <span class="op">=</span> <span class="st">"squeezed at 10my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze30</span>, main <span class="op">=</span> <span class="st">"Squeezed at 30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze50</span>, main <span class="op">=</span> <span class="st">"Squeezed at 50my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>It is noteworthy that setting the <code>dropNodes</code> argument as
TRUE (default is FALSE) alters the tree structure by removing nodes with
no branch lengths from the original tree. We can check this out by
typing:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_squeeze30_drop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, criterion <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze30</span> <span class="co"># full binary tree</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 308 tips and 307 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch length(s).</span></span>
<span><span class="va">tree_squeeze30_drop</span> <span class="co"># tree with nodes dropped</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 308 tips and 58 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch length(s).</span></span></code></pre></div>
<p>You’ll observe that the <code>tree_squeeze30</code> object forms a
full binary tree (308 species and 307 nodes), while the object
<code>tree_squeeze30_drop</code> is not a binary tree, as nodes younger
than 30 million years were dropped out from the tree.</p>
<p>As mentioned before, the tree can be squeezed using different depths
criteria. Let’s explore this by using accumulated phylogenetic diversity
(PD) over the years to squeeze and plotting all trees to observe the
differences. First, lets assess the total PD available within the
tree:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PD_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">edge.length</span><span class="op">)</span></span></code></pre></div>
<p>Then, lets squeeze our tips to the point where 10% and 50% of the
total PD was accumulated in the phylogenetic tree:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_squeeze10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="va">PD_total</span><span class="op">/</span><span class="fl">10</span>, criterion <span class="op">=</span> <span class="st">"pd"</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="va">PD_total</span><span class="op">/</span><span class="fl">2</span>, criterion <span class="op">=</span> <span class="st">"pd"</span><span class="op">)</span></span>
<span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x2 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze10</span>, main <span class="op">=</span> <span class="st">"Tree squeezed at 10% PD"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze50</span>, main <span class="op">=</span> <span class="st">"Tree squeezed at 50% PD"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="slicing-from-the-root-to-the-tips">2.2. Slicing from the root to the tips<a class="anchor" aria-label="anchor" href="#slicing-from-the-root-to-the-tips"></a>
</h3>
<p>Another option available in <code>treesliceR</code> is the
<code><a href="../reference/squeeze_root.html">squeeze_root()</a></code> function, allowing users to squeeze the
phylogenetic tree from the root to the tips using the same depth
criterion and arguments as demonstrated in the previous section. For
instance, let’s squeeze our passerine phylogeny root to 50 million
years:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_root50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_root.html">squeeze_root</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_root50</span>, main <span class="op">=</span> <span class="st">"Tree sliced rootwardly in 50my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/squeezeRoot-1.png" width="700"></p>
<p>Notice that the root of the tree now begins at 50 millions of
years.</p>
</div>
<div class="section level3">
<h3 id="slicing-phylogenies-internally">2.3. Slicing phylogenies internally<a class="anchor" aria-label="anchor" href="#slicing-phylogenies-internally"></a>
</h3>
<p><code>treesliceR</code> also provides the option to slice phylogenies
internally by using the function <code><a href="../reference/squeeze_int.html">squeeze_int()</a></code>. In this
function, the user must specify two values representing the depth
boundaries of the tree that will be retained (or removed) from the
phylogeny.</p>
<p>For example, if we want to keep only branches of the tree lying
between 30 and 10 million years, we can use the following code:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_int.html">squeeze_int</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">10</span>,<span class="op">)</span></span></code></pre></div>
<p>Let’s check out the slice of the tree that was retained and compare
it with the original tree:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x2 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"Original tree"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_int</span>, main <span class="op">=</span> <span class="st">"Tree slice 10-30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> <span class="co"># Returning to the original display</span></span></code></pre></div>
<p><img src="Intro-treesliceR_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Again, it is essential to note that the absolute depths of the tree
will change, but the internal branch lengths will remain the same as the
original values (except for the ones that were sliced).</p>
<p>That’s all folks!</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K. and Mooers, A. O.
2012. The global diversity of birds in space and time. - Nature
491(7424): 444–448. <a href="https://doi.org/10.1038/nature11631" class="external-link uri">https://doi.org/10.1038/nature11631</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matheus Lima Araujo, Luiz Gabriel Souza e Souza Ferreira, Gabriel Nakamura, Marco Tulio Pacheco Coelho, Thiago Fernando Rangel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
