<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="treesliceR">
<title>Introduction to treesliceR • treesliceR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to treesliceR">
<meta property="og:description" content="treesliceR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">treesliceR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro_treeSlicer.html">Introduction to treesliceR</a>
    <a class="dropdown-item" href="../articles/Passeriformes-distribution.html">Passerines Distribution</a>
    <a class="dropdown-item" href="../articles/Passeriformes-diversification.html">Passerines Diversification</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AraujoTheus/treesliceR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to treesliceR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AraujoTheus/treesliceR/blob/HEAD/vignettes/Intro_treeSlicer.Rmd" class="external-link"><code>vignettes/Intro_treeSlicer.Rmd</code></a></small>
      <div class="d-none name"><code>Intro_treeSlicer.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>treesliceR</strong> is an R package that provides tools to
flexibly subset and slice phylogenetic trees at different depths and
ways. Sliced and pruned phylogenies are also ready to be used in
downstream analysis (e.g. to assess phylogenetic patterns like beta and
alpha phylogenetic metrics). With {<code>treesliceR</code>} phylogenies
can be sliced in any temporal orientation (“rootwardly” or “tipwardly”),
and internally by using different temporal criteria (million years,
accumulated phylogenetic diversity or quantiles based on age
distribution).</p>
<p>Moreover, {<code>treesliceR</code>} contain functions to assess the
rates of accumulation of phylogenetic information (e.g., “α” and “β”
diversities) through time (<a href="link%20here">check out this vignette
to an introduction to how to calculate these metrics</a>). All the
analysis are designed to be flexible, reliable and fast, since functions
that are computationally time-demanding were designed to run under
parallel computation. Finally, our package also provides plotting
functions that allows to produce <a href="">ready-to-use
figures</a>.</p>
<p>In order to illustrate the basic use of <code>treesliceR</code> we
will present some examples on how to subset and slice phylogenies in
different ways. To do that we will need the following packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">libs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ape"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Checking if they're installed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">libs</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">libs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Loading them</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span></code></pre></div>
<p>Now, we’ll need to load (and install if necessary) the
<code>treesliceR</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Is it already present within the machine?</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"treesliceR"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"AraujoMat/treesliceR"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Loading it</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AraujoTheus/treesliceR" class="external-link">treesliceR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="subsetting-and-slicing-phylogenies">Subsetting and slicing phylogenies<a class="anchor" aria-label="anchor" href="#subsetting-and-slicing-phylogenies"></a>
</h2>
<p>treesliceR provides a set of functions that can be used to slice
phylogenetic trees in different ways. Slicing phylogenies can be used
for different tasks, from vizualization purposes to conduct downstream
analysis (<a href="https://araujomat.github.io/treesliceR/articles/Passeriformes-distribution.html">see
this vignette for an example</a>).</p>
<p>In order to illustrate the flexibility of treesliceR we will
demonstrate how to subset and slice a phylogenetic tree of passarine
species (308 species) presented in the package. The object
<code>pass_tree</code> comprises a multiphylo object with 100
phylogenetic trees. For the sake of simplicity we will use only one
tree. To load this dataset use the following code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AraujoTheus/treesliceR" class="external-link">treesliceR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pass_trees"</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">pass_trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prunning-function">Prunning function<a class="anchor" aria-label="anchor" href="#prunning-function"></a>
</h2>
<p>treesliceR has functions that allow to prune a phylogenetic tree
based on a specific absolute tree depth or by setting a quantile based
on the age distribution of the last sppliting events in the phylogenetic
tree. In both procedures (absolute age or quantile), all tips that have
the age of the last splitting event <strong>after</strong> or
<strong>before</strong> the value specified in the time argument will be
pruned off or kept in the phylogeny (depending the <code>method</code>
argument). In the next examples we will show how to prune the
phylogenetic tree using an absolute depth (in this case in million
years) or a scalar indicating a quantile draw from species age
distribution.</p>
<div class="section level3">
<h3 id="prunning-using-absolute-depth">Prunning using absolute depth<a class="anchor" aria-label="anchor" href="#prunning-using-absolute-depth"></a>
</h3>
<p>First, lets prune the phylogeny in a way to keep only species that
have splitting events older than 10 and 30 million years.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span>, qtl <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># keep species older than 10myr</span></span>
<span><span class="va">tree_pruned30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, qtl <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># keep species older than 30myr</span></span></code></pre></div>
<p>Lets check the format of those trees</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"All species"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned10</span>, main <span class="op">=</span> <span class="st">"Species older than 10my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned30</span>, main <span class="op">=</span> <span class="st">"Species older than 30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We can see that only species in which the last sppliting event are
greater than 10 and 30 million years are kept in the trees. It is worth
to note that the original branch lengths are not changed. From the left
to the right we have the original phylogeny, the phylogeny containing
only species in which the last splitting event is older than 10myr and,
finally, the phylogeny with species that the last branching event is
older than 30myr (only three species in our example).</p>
<p>The inverse procedure can be done, i.e. we can keep only the species
with the last branching event that is younger than the <code>time</code>
argument by setting the <code>method</code> argument as 2.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned10_inverse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span>, qtl <span class="op">=</span> <span class="cn">F</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># keep species younger than 10myr</span></span>
<span><span class="va">tree_pruned30_inverse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, qtl <span class="op">=</span> <span class="cn">F</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># keep species younger than 30myr</span></span>
<span></span>
<span><span class="co"># plotting phylogenies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"All species"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned10_inverse</span>, main <span class="op">=</span> <span class="st">"Species younger than 10my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned30_inverse</span>, main <span class="op">=</span> <span class="st">"Species younger than 30my"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/unnamed-chunk-6-1.png" width="700">
## Prunning using depth quantiles</p>
<p>The same procedure can be done by setting the <code>time</code>
argument as a scalar indicating the quantile of the distribution of
species ages (given by the time of the last branching event). For
example, if we want to keep only the species with age values younger
(lower) than the ages of 25th quantile of the age distribution of all
species, we can do the following:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_pruned25q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune_tips.html">prune_tips</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fl">0.25</span>, qtl <span class="op">=</span> <span class="cn">T</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pruned25q</span>, main <span class="op">=</span> <span class="st">"Species with ages younger than 25th quantile"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Note that if we want to keep the species with ages younger than the
ages of the 25th quantile we set the <code>method</code> argument as 2,
as in the example above. The default value is 1, i.e., we remove the
tips with ages younger than the threshold specified in <code>time</code>
argument.</p>
</div>
</div>
<div class="section level2">
<h2 id="slicing-functions">Slicing functions<a class="anchor" aria-label="anchor" href="#slicing-functions"></a>
</h2>
<p>The second family of functions present in {<code>treesliceR</code>}
allows to slice the phylogeny in different ways. In this section we will
show the flexibility of tressliceR to perform tree slicing and visualize
the output of these functions.</p>
<div class="section level3">
<h3 id="slicing-from-tip-to-roots">Slicing from tip to roots<a class="anchor" aria-label="anchor" href="#slicing-from-tip-to-roots"></a>
</h3>
<p>The first option to slice phylogenies is by squeezing its branch
lengths from the tips to the root using the function
<code>squeeze_int</code>. By squeezing we mean collapsing the branch
lengths accordingly to a given threshold (tree depth, in this case in
million of years). In this function we need to provide a phylogenetic
tree and a numeric value indicating the depth in which the branches will
be squeezed. For example, let’s squeeze the passerine phylogeny up to
three different ages: 10, 30 and 50 million years (myr).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tree_squeeze10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">10</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">50</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the phylogeny before and after the squeezing process to
check out the difference</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x3 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze10</span>, main <span class="op">=</span> <span class="st">"squeezed at 10myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze30</span>, main <span class="op">=</span> <span class="st">"Squeezed at 30myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze50</span>, main <span class="op">=</span> <span class="st">"Squeezed at 50myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/plotSqueeze-1.png" width="700"></p>
<p>It is worth to note that when we set the argument
<code>dropNodes</code> as TRUE we change the structure of the tree by
removing the nodes from the original tree. We can check this out by
typping:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_squeeze30_drop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">30</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze30</span> <span class="co"># full binary tree</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 308 tips and 307 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch lengths.</span></span>
<span><span class="va">tree_squeeze30_drop</span> <span class="co"># tree with nodes dropped</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 308 tips and 58 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   Pitta_iris, Pitta_versicolor, Pitta_erythrogaster, Atrichornis_clamosus, Atrichornis_rufescens, Menura_alberti, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch lengths.</span></span></code></pre></div>
<p>You can see that the object <code>tree_squeeze30</code> is a full
binary tree (308 species and 307 nodes), while the object
<code>tree_squeeze30_drop</code> is not a binary tree since the nodes
younger than 30myr were dropped out of the tree.</p>
<p>As mentioned before, we can squeeze the tree using different depths.
Let’s play around with 20 and 40 myr and plot all trees to check the
differences.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_squeeze20</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">20</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tree_squeeze40</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_tips.html">squeeze_tips</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">40</span>, criteria <span class="op">=</span> <span class="st">"my"</span>, dropNodes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x2 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze20</span>, main <span class="op">=</span> <span class="st">"Tree squeezed at 20myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_squeeze40</span>, main <span class="op">=</span> <span class="st">"Tree squeezed at 40myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/plotSqueeze2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="slicing-from-root-to-tip">Slicing from root to tip<a class="anchor" aria-label="anchor" href="#slicing-from-root-to-tip"></a>
</h3>
<p>Another option implemented in treeSlicer is the function
<code>squeeze_root</code>, in which the user can squeeze the
phylogenetic tree from the root to the tips using the same depth
criteria used before.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_root50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_root.html">squeeze_root</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, time <span class="op">=</span> <span class="fl">50</span>, criteria <span class="op">=</span> <span class="st">"my"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_root50</span>, main <span class="op">=</span> <span class="st">"Tree sliced rootwardly in 50myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/squeezeRoot-1.png" width="700">
Note that the root of the tree is now 50myr.</p>
</div>
<div class="section level3">
<h3 id="slicing-phylogenies-internally">Slicing phylogenies internally<a class="anchor" aria-label="anchor" href="#slicing-phylogenies-internally"></a>
</h3>
<p>treesliceR also have the option of slice phylogenies internally by
using the function <code>squeeze_int</code>. In this function the user
must specify two values that represents the depth boundaries of the tree
that will be kept or removed from the phylogeny.</p>
<p>For example, if we want to keep only branches of the tree that lies
between 30myr and 10myr, we can use the following code</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/squeeze_int.html">squeeze_int</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">10</span>, criteria <span class="op">=</span> <span class="st">"my"</span><span class="op">)</span></span></code></pre></div>
<p>Lets check out the slice of the tree that was kept and compare with
the original tree</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># Setting an 1x2 graphical display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span>, main <span class="op">=</span> <span class="st">"Original tree"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_int</span>, main <span class="op">=</span> <span class="st">"Tree slice 10-30 myr"</span>, show.tip.label <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html" class="external-link">axisPhylo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Intro_treeSlicer_files/figure-html/unnamed-chunk-10-1.png" width="700">
Again, it is worth to note that the absolute depths of the tree will
change but the internal branch lengths will be kept the same as the
original values (except the ones that were sliced).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matheus Lima Araujo, Luiz Gabriel Souza e Souza Ferreira, Marco Tulio Pacheco Coelho, Gabriel Nakamura, Thiago Fernando Rangel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
